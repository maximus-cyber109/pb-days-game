<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>PB Days Rewards & Redemption</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ‘‘</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Bungee+Spice&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/styles.css" />
  <script>
    window.APP_CONFIG = {
      SUPABASE_URL: "https://bizfudxxmqohlllidcgj.supabase.co",
      SUPABASE_KEY: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJpemZ1ZHh4bXFvaGxsbGlkY2dqIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMxODM2NjYsImV4cCI6MjA3ODc1OTY2Nn0._VzTpjPudZ9kyq-cHKR-0xJP8rix7pgntjL2Acc3hY0"
    };
  </script>

  <!-- NO Webengage scripts -->
</head>
<body>
  
  <div class="stars">
    <div class="star"></div><div class="star"></div><div class="star"></div>
    <div class="star"></div><div class="star"></div><div class="star"></div>
  </div>

  <img src="https://email-editor-resources.s3.amazonaws.com/images/82618240/Logo.png" alt="PB Days" class="pb-logo" />

  <div id="card-slider-container" class="card-slider-container" style="display:none;">
    <div class="card-slider-track" id="card-slider-track"></div>
  </div>

  <div id="slider-bar-row">
    <div class="coc-progress-bar">
      <div class="coc-progress-inner" id="coc-progress-inner"></div>
      <div class="coc-progress-text" id="slider-text">0/7</div>
      <div id="slider-rocks" class="coc-rocks-container"></div>
  </div>
  
  <div class="button-container">
    <button class="btn-3d-glass" id="open-gallery">View All My Cards</button>
  </div>

  <!-- This section will be hidden or replaced if already redeemed -->
  <div id="redemption-area">
    <div class="button-container" style="margin-top: 1.5em;">
      <button class="btn-3d-glass" id="show-pb-cash" style="display:none; background: linear-gradient(145deg,#fdd835 50%,#fff59d 100%); color: #3f227b;">
        Redeem PB CASH
      </button>
    </div>

    <div class="mini-title" style="color:#fedc07;">Your Rewards</div>
    
    <!-- NEW: Short Rules Text -->
    <div class="reward-rules-explainer-short">
      You get <strong>one redemption</strong>. Save up cards to unlock higher tiers!
    </div>
    
    <div id="reward-section" class="reward-grid">
      <!-- JS will fill this area -->
    </div>
  </div>
  
  <!-- This section will be shown if already redeemed -->
  <div id="already-redeemed-area" class="reward-tier1-prompt" style="display: none; margin-top: 2em; text-align: center;">
    <img id="redeemed-item-img" src="" alt="Redeemed Item" />
    <div id="redeemed-item-message">
      <!-- JS will fill this message -->
    </div>
  </div>
  
  <div class="mini-title" style="margin-top:2.2em;">Leaderboard</div>
  <div id="leaderboard" class="leaderboard-container"></div>
  
  <a href="https://pinkblue.in" class="btn-3d-glass shop-more-btn" target="_blank" rel="noopener noreferrer">
    Shop More
  </a>

  <!-- NEW: Rules Modal (Shown on load) -->
  <div class="modal-bg" id="rules-modal">
    <div class="modal-fg">
      <div class="pb-cash-text">Welcome, Collector!</div>
      <div class="redeem-success-delivery" style="font-size: 1rem; color: #eee; text-align: left; line-height: 1.6;">
        Here's how it works:<br><br>
        1. All cards you earn are added to your collection.<br>
        2. You get <strong>one redemption per account</strong>, ever.<br>
        3. You can redeem now, or...<br>
        4. ...keep ordering to collect more cards and unlock the best rewards!
      </div>
      <button class="btn-3d-glass" id="rules-continue-btn" style="font-size: 1.3rem; margin-top: 1.5em;">Continue</button>
    </div>
  </div>

  <!-- Gallery Modal (for "View All My Cards") -->
  <div class="modal-bg" id="gallery-modal">
    <!-- ... (modal content from previous step) ... -->
    <div class="modal-fg gallery-modal-content">
      <button id="gallery-left" class="gallery-arrow-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256"><path d="M165.66,202.34a8,8,0,0,1-11.32,11.32l-80-80a8,8,0,0,1,0-11.32l80-80a8,8,0,0,1,11.32,11.32L91.31,128Z"></path></svg>
      </button>
      <img id="gallery-card-img" src="" alt="card" class="gallery-card-img" />
      <button id="gallery-right" class="gallery-arrow-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 256 256"><path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path></svg>
      </button>
      <div id="gallery-card-name" class="gallery-card-name"></div>
      <button class="btn-3d-glass" id="gallery-close" style="margin-top:1.1em;">Close</button>
    </div>
  </div>

  <!-- PB CASH Modal -->
  <div class="modal-bg" id="pb-cash-modal">
    <!-- ... (modal content from previous step) ... -->
    <div class="modal-fg">
      <div class="pb-cash-text" id="pb-cash-text"></div>
      <button class="btn-3d-glass" id="pb-cash-claim">Claim PB CASH</button>
      <button class="btn-3d-glass btn-close" id="pb-cash-close">Close</button>
    </div>
  </div>

  <!-- Redeem Success Modal -->
  <div class="modal-bg" id="redeem-success-modal">
    <!-- ... (modal content from previous step) ... -->
    <div class="modal-fg">
      <div class="redeem-success-title">Reward Claimed!</div>
      <img id="redeem-success-img" src="" alt="product" class="redeem-success-img" />
      <div id="redeem-success-name" class="redeem-success-name"></div>
      <div id="redeem-success-delivery" class="redeem-success-delivery">
        Your product will be sent out once the order is delivered.
      </div>
      <button class="btn-3d-glass btn-close" id="redeem-success-close">Awesome!</button>
    </div>
  </div>
  
  <!-- App scripts -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/config.js"></script>
  <script src="js/reward-logic.js"></script>
  <script src="js/supabase-client.js"></script>
  <script src="js/app-redeem.js"></script>
</body>
</html>
